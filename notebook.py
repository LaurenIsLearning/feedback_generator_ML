# -*- coding: utf-8 -*-
"""notebook.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Tc7_-fE_v5KyurG96dmwGrchO3Qh4yE2

# Main Feedback Generation Notebook
This notebook handles preprocessing, model interaction, and feedback generation.

**--Set up: Github, Paths, Imports**
"""

# Commented out IPython magic to ensure Python compatibility.
# Mount Google Drive (optional, you'll get a prompt to authorize account)
# from google.colab import drive
# drive.mount('/content/drive')

# Start in root Colab directory to avoid nesting
# %cd /content

# Clone your GitHub repo (replace with your actual repo URL)
!git clone https://github.com/ML-name/project.git
# %cd project

# List all branches (optional, for checking)
!git branch -a

# Checkout YOUR branch (!!replace "your-branch-name"!!)
!git checkout scraping/rubric_table

"""**--Install required libraries and set paths**"""

# Commented out IPython magic to ensure Python compatibility.
# %pip install -r requirements.txt
!pip install python-docx

# import data path for loading files
import os

# Base data directory
data_base = '/content/project/data'

# Paths to specific subfolders
raw_data_path = os.path.join(data_base, 'raw')
processed_data_path = os.path.join(data_base, 'processed')

"""**--Import modules (youre working on)**
<br>*each of our classes will be what will merge to this notebook (im p sure)*
<br>only loads what you explicitly request
<br>(this helps keep memory low and import fast)
<br> *the following is an example with my Rubric module*

## Rubric scraper
"""

# Add your src folder to the Python path
import sys
sys.path.append('/content/project/')

from tropos.preprocess_docx.rubric import Rubric, parse_rubric

from docx import Document

# loop through tables and cells
rubric = parse_rubric("/content/project/data/raw/Student 1/Student 1 Part 1.docx")
print(rubric.get_criteria())

rubric = parse_rubric("/content/project/data/raw/Student 1/Student 1 Part 1.docx")

for row in rubric.get_criteria():
    print("Portion:", row["portion"])
    print("Criteria:", row["criteria"]["text"])
    print("Feedback:", row["feedback"])
    print("-" * 50)

